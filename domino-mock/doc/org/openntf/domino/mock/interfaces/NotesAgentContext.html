<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (version 1.7.0_07) on Wed May 15 08:04:03 CEST 2013 -->
<title>NotesAgentContext (Domino Mock Documentation)</title>
<meta name="date" content="2013-05-15">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="NotesAgentContext (Domino Mock Documentation)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/NotesAgentContext.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgent.html" title="interface in org.openntf.domino.mock.interfaces"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/openntf/domino/mock/interfaces/NotesBase.html" title="interface in org.openntf.domino.mock.interfaces"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/openntf/domino/mock/interfaces/NotesAgentContext.html" target="_top">Frames</a></li>
<li><a href="NotesAgentContext.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.openntf.domino.mock.interfaces</div>
<h2 title="Interface NotesAgentContext" class="title">Interface NotesAgentContext</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><a href="../../../../../org/openntf/domino/mock/interfaces/NotesBase.html" title="interface in org.openntf.domino.mock.interfaces">NotesBase</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="strong">NotesAgentContext</span>
extends <a href="../../../../../org/openntf/domino/mock/interfaces/NotesBase.html" title="interface in org.openntf.domino.mock.interfaces">NotesBase</a></pre>
<div class="block">Represents the agent environment of the current program, if an agent is
 running it.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>Sven Dreher</dd>
<dt><span class="strong">Access:</span></dt>
  <dd>Use <a href="../../../../../org/openntf/domino/mock/interfaces/NotesSession.html#getAgentContext()"><code>NotesSession.getAgentContext()</code></a> in Session to get the
         AgentContext object for the current agent.</dd>
<dt><span class="strong">Usage:</span></dt>
  <dd>You can create a Java agent by importing files or by writing and
        compiling the code in Lotus Domino Designer. In the latter case, Lotus
        Domino Designer provides template code that creates a Session object
        named session and an AgentContext object named agentContext. The
        complete template code appears as follows:
 
        <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent gets the context for the current agent, then gets the
          agent itself and prints the agent name and comment.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        Agent agent = agentContext.getCurrentAgent();
                        String name = agent.getName();
                        String comment = agent.getComment();
                        if (comment.equals(&quot;&quot;))
                                comment = &quot;No comment&quot;;
                        System.out.println(&quot;Current agent: \&quot;&quot; + name + &quot;\&quot;&quot;);
                        System.out.println(&quot;Comment: \&quot;&quot; + comment + &quot;\&quot;&quot;);
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgent.html" title="interface in org.openntf.domino.mock.interfaces">NotesAgent</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#getCurrentAgent()">getCurrentAgent</a></strong>()</code>
<div class="block">The agent that's currently running.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDatabase.html" title="interface in org.openntf.domino.mock.interfaces">NotesDatabase</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#getCurrentDatabase()">getCurrentDatabase</a></strong>()</code>
<div class="block">The database in which the current agent resides.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocument.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocument</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#getDocumentContext()">getDocumentContext</a></strong>()</code>
<div class="block">The in-memory document when an agent starts.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#getEffectiveUserName()">getEffectiveUserName</a></strong>()</code>
<div class="block">The user name that is in effect for the current program.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#getLastExitStatus()">getLastExitStatus</a></strong>()</code>
<div class="block">The exit status code returned by the Agent Manager the last time the
 current agent ran.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDateTime.html" title="interface in org.openntf.domino.mock.interfaces">NotesDateTime</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#getLastRun()">getLastRun</a></strong>()</code>
<div class="block">The date and time when the current agent was last executed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocument.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocument</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#getSavedData()">getSavedData</a></strong>()</code>
<div class="block">A document that an agent uses to store information between invocations.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#getUnprocessedDocuments()">getUnprocessedDocuments</a></strong>()</code>
<div class="block">The documents in a database that the current agent considers to be
 "unprocessed."</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#unprocessedFTSearch(java.lang.String, int)">unprocessedFTSearch</a></strong>(java.lang.String&nbsp;query,
                   int&nbsp;maxDocs)</code>
<div class="block">Given a full-text query, returns documents in a database:
 
 That the current agent considers to be unprocessed
 And that match the query
 </div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#unprocessedFTSearch(java.lang.String, int, int, int)">unprocessedFTSearch</a></strong>(java.lang.String&nbsp;query,
                   int&nbsp;maxDocs,
                   int&nbsp;sortOpt,
                   int&nbsp;otherOpt)</code>
<div class="block">Given a full-text query, returns documents in a database:
 
 That the current agent considers to be unprocessed
 And that match the query
 </div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#unprocessedFTSearchRange(java.lang.String, int, int)">unprocessedFTSearchRange</a></strong>(java.lang.String&nbsp;query,
                        int&nbsp;maxDocs,
                        int&nbsp;start)</code>
<div class="block">Given a full-text query, returns documents in a database:
 
 
 That the current agent considers to be unprocessed
 And that match the query
 </div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#unprocessedFTSearchRange(java.lang.String, int, int, int, int)">unprocessedFTSearchRange</a></strong>(java.lang.String&nbsp;query,
                        int&nbsp;maxdocs,
                        int&nbsp;sortopt,
                        int&nbsp;otheropt,
                        int&nbsp;start)</code>
<div class="block">Given a full-text query, returns documents in a database:
 
 
 That the current agent considers to be unprocessed
 And that match the query
 </div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#unprocessedSearch(java.lang.String, org.openntf.domino.mock.interfaces.NotesDateTime, int)">unprocessedSearch</a></strong>(java.lang.String&nbsp;formula,
                 <a href="../../../../../org/openntf/domino/mock/interfaces/NotesDateTime.html" title="interface in org.openntf.domino.mock.interfaces">NotesDateTime</a>&nbsp;limit,
                 int&nbsp;maxDocs)</code>
<div class="block">Given selection criteria, returns documents in a database that:
 
 The current agent considers to be unprocessed
 Meet the selection criteria
 Were created or modified since the cutoff date
 </div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#updateProcessedDoc(org.openntf.domino.mock.interfaces.NotesDocument)">updateProcessedDoc</a></strong>(<a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocument.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocument</a>&nbsp;doc)</code>
<div class="block">Marks a document as processed by an agent.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_org.openntf.domino.mock.interfaces.NotesBase">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.openntf.domino.mock.interfaces.<a href="../../../../../org/openntf/domino/mock/interfaces/NotesBase.html" title="interface in org.openntf.domino.mock.interfaces">NotesBase</a></h3>
<code><a href="../../../../../org/openntf/domino/mock/interfaces/NotesBase.html#recycle()">recycle</a>, <a href="../../../../../org/openntf/domino/mock/interfaces/NotesBase.html#recycle(java.util.Vector)">recycle</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="updateProcessedDoc(org.openntf.domino.mock.interfaces.NotesDocument)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateProcessedDoc</h4>
<pre>void&nbsp;updateProcessedDoc(<a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocument.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocument</a>&nbsp;doc)
                        throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">Marks a document as processed by an agent.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>doc</code> - The document to be marked as processed. Cannot be null.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>Use this method in conjunction with
        <a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#getUnprocessedDocuments()"><code>getUnprocessedDocuments()</code></a>,
        <a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#unprocessedFTSearch(java.lang.String, int)"><code>unprocessedFTSearch(String, int)</code></a>, and
        <a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgentContext.html#unprocessedSearch(java.lang.String, org.openntf.domino.mock.interfaces.NotesDateTime, int)"><code>unprocessedSearch(String, NotesDateTime, int)</code></a> in an agent
        that runs on all new and modified documents.
 
        This method marks a document so subsequent invocations of the same
        agent recognize the document as processed. You must explicitly
        mark a document with this method. No implicit marking occurs in a
        Java agent.
 
        If a marked document is modified, it is unmarked and will be
        processed by the next invocation of the agent.
 
        This method marks a document as processed only for the particular
        agent from which it is called. Using this method in one agent has
        no effect on the documents that another agent processes.</dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This program is for an agent that runs on newly created and
          modified documents since the last run. The program gets the
          unprocessed documents, prints each Subject item, and marks each
          document as processed. The first time the agent runs,
          getUnprocessedDocuments returns all of the documents in the
          database. Thereafter, getUnprocessedDocuments returns those
          documents that updateProcessedDoc has not touched.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        DocumentCollection dc = agentContext.getUnprocessedDocuments();
                        Document doc = dc.getFirstDocument();
                        while (doc != null) {
                                System.out.println(doc.getItemValueString(&quot;Subject&quot;));
                                agentContext.updateProcessedDoc(doc);
                                doc = dc.getNextDocument();
                        }
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="unprocessedFTSearch(java.lang.String, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unprocessedFTSearch</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a>&nbsp;unprocessedFTSearch(java.lang.String&nbsp;query,
                                          int&nbsp;maxDocs)
                                            throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">Given a full-text query, returns documents in a database:
 <ul>
 <li>That the current agent considers to be unprocessed</li>
 <li>And that match the query</li>
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>query</code> - The full-text query.</dd><dd><code>maxDocs</code> - The maximum number of documents you want returned; 0 means all
            matching documents.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A sorted collection of documents that are not yet processed and
         match the query.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>This method is valid only for agents.<br>
 
        <b>How does it work?</b><br>
        This method works in two parts:<br>
 
        <ul>
        <li>First, it finds a collection of documents that the agent
        considers to be "unprocessed." The type of agent determines which
        documents are considered to be unprocessed. This document
        collection is identical to that returned by
        getUnprocessedDocuments.</li>
        <li>Second, it conducts a full-text search on the unprocessed
        documents and returns a collection of those documents that match
        the query.</li>
        </ul>
        For example, in an agent that runs on all selected documents in a
        view, getUnprocessedFTSearch searches only the selected documents
        and returns those that match the query. In an agent that runs on
        all new and modified documents since the last run,
        getUnprocessedFTSearch searches only the documents that were not
        marked by updateProcessedDoc, and returns those that match the
        query.<br>
 <br>
        <b>What documents are returned?</b><br>
        The following table describes the documents that are returned by
        unprocessedFTSearch. Document selection occurs once, before the
        agent runs.
 
        <table border="1">
        <tr>
        <th>Agent runs on:</th>
        <th>UnprocessedDocuments returns documents that meet all of these
        requirements:</th>
        </tr>
        <tr>
        <td>All documents in database</td>
        <td>Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search critieria specified in this method</td>
        </tr>
        <tr>
        <td>All new & modified documents</td>
        <td>Not processed by this agent with updateProcessedDoc<br>
 
        Created or modified since the agent last ran<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search critieria specified in this method</td>
        </tr>
        <tr>
        <td>All unread documents in view</td>
        <td>Are unread and in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>All documents in view</td>
        <td>Are in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>All selected documents</td>
        <td>Are selected in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>None</td>
        <td>Is the current document only</td>
        </tr>
        </table>
 
        <b>Using updateProcessedDoc</b><br>
        For agents that run on new and modified documents, you must use
        updateProcessedDoc to mark each document as "processed," which
        ensures that a document gets processed by the agent only once
        (unless it's modified again). If you do not call this method for
        each document, the agent processes the same documents the next
        time it runs.<br>
 
        The updateProcessedDoc method marks a document as processed only
        for the particular agent from which it is called. Using
        updateProcessedDoc in one agent has no effect on the documents
        that another agent processes.<br>
 
        In all other agents and view actions, updateProcessedDoc has no
        effect.<br>
 
        <b>View actions</b><br>
        When used in a view action, unprocessedFTSearch returns the same
        documents as an agent that runs on selected documents.<br>
 
        <b>Full-text indexes</b><br>
        If the database is not full-text indexed, this method works, but
        less efficiently. To test for an index, use isFTIndexed. To create
        an index on a local database, use updateFTIndex.<br>
 
        This method returns a maximum of 5,000 documents by default. The
        Notes.ini variable FT_MAX_SEARCH_RESULTS overrides this limit for
        indexed databases or databases that are not indexed but that are
        running in an agent on the client. For a database that is not
        indexed and is running in an agent on the server, you must set the
        TEMP_INDEX_MAX_DOC Notes.ini variable as well. The absolute
        maximum is 2,147,483,647.<br>
 
        <b>Options</b><br>
        If you don't specify any sort options, the documents are sorted by
        relevance score. When the collection is sorted by relevance the
        highest relevance appears first. To access the relevance score of
        each document in the collection, use FTSearchScore in Document.<br>
 
        If you ask for a sort by date, you don't get relevance scores. If
        you pass the resulting DocumentCollection to a Newsletter object,
        it formats its doclink report with either the document creation
        date or the relevance score, depending on the sort options.<br>
 
        <b>Query syntax</b><br>
        To search for a word or phrase, enter the word or phrase as is,
        except that search keywords must be enclosed in quotes. Remember
        to escape quotes if you are inside a literal.<br>
 
        Wildcards, operators, and other syntax are permitted. For the
        complete syntax rules, see
        "Refining a search query using operators" in Lotus Notes Help.
        Search for "query syntax" in the Domino Designer Eclipse help
        system or information center (for example,
        http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp),
        both of which include Lotus Notes.<br></dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent runs on all or selected documents. It puts all
          documents that contain the word "botany" in the folder
          "Botanist's Delight."
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        DocumentCollection dc = agentContext.unprocessedFTSearch(&quot;botany&quot;,
                                        0, Database.FT_SCORES, Database.FT_STEMS);
                        System.out.println(&quot;Count = &quot; + dc.getCount());
                        Document doc = dc.getFirstDocument();
                        while (doc != null) {
                                doc.putInFolder(&quot;Botanist's Delight&quot;);
                                System.out.println(doc.getItemValueString(&quot;Subject&quot;));
                                doc = dc.getNextDocument();
                        }
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="unprocessedFTSearch(java.lang.String, int, int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unprocessedFTSearch</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a>&nbsp;unprocessedFTSearch(java.lang.String&nbsp;query,
                                          int&nbsp;maxDocs,
                                          int&nbsp;sortOpt,
                                          int&nbsp;otherOpt)
                                            throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">Given a full-text query, returns documents in a database:
 <ul>
 <li>That the current agent considers to be unprocessed</li>
 <li>And that match the query</li>
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>query</code> - The full-text query.</dd><dd><code>maxDocs</code> - The maximum number of documents you want returned; 0 means all
            matching documents.</dd><dd><code>sortOpt</code> - Use one of these to specify a sorting option:
 
            <ul>
            <li>Database.FT_SCORES (default) sorts by relevance score with
            highest relevance first.</li>
            <li>Database.FT_DATECREATED_DES sorts by document creation
            date in descending order.</li>
            <li>Database.FT_DATECREATED_ASC sorts by document creation
            date in ascending order.</li>
            <li>Database.FT_DATE_DES sorts by document date in descending
            order.</li>
            <li>Database.FT_DATE_ASC sorts by document date in ascending
            order.</li>
            </ul></dd><dd><code>otherOpt</code> - Integer. Use the following constants to specify additional
            search options. To specify more than one option, use a logical
            OR operation
            <ul>
            <li>Database.FT_DATABASE includes Lotus Domino databases in
            the search scope.</li>
            <li>Database.FT_FILESYSTEM includes files other than Lotus
            Domino databases in the search scope.</li>
            <li>Database.FT_FUZZY specifies a fuzzy search.</li>
            <li>Database.FT_STEMS uses stem words as the basis of the
            search.</li>
            </ul></dd>
<dt><span class="strong">Returns:</span></dt><dd>A sorted collection of documents that are not yet processed and
         match the query.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>This method is valid only for agents.<br>
 
        <b>How does it work?</b><br>
        This method works in two parts:<br>
 
        <ul>
        <li>First, it finds a collection of documents that the agent
        considers to be "unprocessed." The type of agent determines which
        documents are considered to be unprocessed. This document
        collection is identical to that returned by
        getUnprocessedDocuments.</li>
        <li>Second, it conducts a full-text search on the unprocessed
        documents and returns a collection of those documents that match
        the query.</li>
        </ul>
        For example, in an agent that runs on all selected documents in a
        view, getUnprocessedFTSearch searches only the selected documents
        and returns those that match the query. In an agent that runs on
        all new and modified documents since the last run,
        getUnprocessedFTSearch searches only the documents that were not
        marked by updateProcessedDoc, and returns those that match the
        query.<br>
 <br>
        <b>What documents are returned?</b><br>
        The following table describes the documents that are returned by
        unprocessedFTSearch. Document selection occurs once, before the
        agent runs.
 
        <table border="1">
        <tr>
        <th>Agent runs on:</th>
        <th>UnprocessedDocuments returns documents that meet all of these
        requirements:</th>
        </tr>
        <tr>
        <td>All documents in database</td>
        <td>Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search critieria specified in this method</td>
        </tr>
        <tr>
        <td>All new & modified documents</td>
        <td>Not processed by this agent with updateProcessedDoc<br>
 
        Created or modified since the agent last ran<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search critieria specified in this method</td>
        </tr>
        <tr>
        <td>All unread documents in view</td>
        <td>Are unread and in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>All documents in view</td>
        <td>Are in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>All selected documents</td>
        <td>Are selected in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>None</td>
        <td>Is the current document only</td>
        </tr>
        </table>
 
        <b>Using updateProcessedDoc</b><br>
        For agents that run on new and modified documents, you must use
        updateProcessedDoc to mark each document as "processed," which
        ensures that a document gets processed by the agent only once
        (unless it's modified again). If you do not call this method for
        each document, the agent processes the same documents the next
        time it runs.<br>
 
        The updateProcessedDoc method marks a document as processed only
        for the particular agent from which it is called. Using
        updateProcessedDoc in one agent has no effect on the documents
        that another agent processes.<br>
 
        In all other agents and view actions, updateProcessedDoc has no
        effect.<br>
 
        <b>View actions</b><br>
        When used in a view action, unprocessedFTSearch returns the same
        documents as an agent that runs on selected documents.<br>
 
        <b>Full-text indexes</b><br>
        If the database is not full-text indexed, this method works, but
        less efficiently. To test for an index, use isFTIndexed. To create
        an index on a local database, use updateFTIndex.<br>
 
        This method returns a maximum of 5,000 documents by default. The
        Notes.ini variable FT_MAX_SEARCH_RESULTS overrides this limit for
        indexed databases or databases that are not indexed but that are
        running in an agent on the client. For a database that is not
        indexed and is running in an agent on the server, you must set the
        TEMP_INDEX_MAX_DOC Notes.ini variable as well. The absolute
        maximum is 2,147,483,647.<br>
 
        <b>Options</b><br>
        If you don't specify any sort options, the documents are sorted by
        relevance score. When the collection is sorted by relevance the
        highest relevance appears first. To access the relevance score of
        each document in the collection, use FTSearchScore in Document.<br>
 
        If you ask for a sort by date, you don't get relevance scores. If
        you pass the resulting DocumentCollection to a Newsletter object,
        it formats its doclink report with either the document creation
        date or the relevance score, depending on the sort options.<br>
 
        <b>Query syntax</b><br>
        To search for a word or phrase, enter the word or phrase as is,
        except that search keywords must be enclosed in quotes. Remember
        to escape quotes if you are inside a literal.<br>
 
        Wildcards, operators, and other syntax are permitted. For the
        complete syntax rules, see
        "Refining a search query using operators" in Lotus Notes Help.
        Search for "query syntax" in the Domino Designer Eclipse help
        system or information center (for example,
        http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp),
        both of which include Lotus Notes.<br></dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent runs on all or selected documents. It puts all
          documents that contain the word "botany" in the folder
          "Botanist's Delight."
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        DocumentCollection dc = agentContext.unprocessedFTSearch(&quot;botany&quot;,
                                        0, Database.FT_SCORES, Database.FT_STEMS);
                        System.out.println(&quot;Count = &quot; + dc.getCount());
                        Document doc = dc.getFirstDocument();
                        while (doc != null) {
                                doc.putInFolder(&quot;Botanist's Delight&quot;);
                                System.out.println(doc.getItemValueString(&quot;Subject&quot;));
                                doc = dc.getNextDocument();
                        }
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="unprocessedFTSearchRange(java.lang.String, int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unprocessedFTSearchRange</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a>&nbsp;unprocessedFTSearchRange(java.lang.String&nbsp;query,
                                               int&nbsp;maxDocs,
                                               int&nbsp;start)
                                                 throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">Given a full-text query, returns documents in a database:
 
 <ul>
 <li>That the current agent considers to be unprocessed</li>
 <li>And that match the query</li>
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>query</code> - The full-text query.</dd><dd><code>maxDocs</code> - The maximum number of documents you want returned; 0 means all
            matching documents.</dd><dd><code>start</code> - The starting document to return.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A sorted collection of documents that are not yet processed and
         match the query.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>This method is valid only for agents.<br>
 
        <b>How does it work?</b><br>
        This method works in two parts:<br>
 
        <ul>
        <li>First, it finds a collection of documents that the agent
        considers to be "unprocessed." The type of agent determines which
        documents are considered to be unprocessed. This document
        collection is identical to that returned by
        getUnprocessedDocuments.</li>
        <li>Second, it conducts a full-text search on the unprocessed
        documents and returns a collection of those documents that match
        the query.</li>
        </ul>
        For example, in an agent that runs on all selected documents in a
        view, getUnprocessedFTSearch searches only the selected documents
        and returns those that match the query. In an agent that runs on
        all new and modified documents since the last run,
        getUnprocessedFTSearch searches only the documents that were not
        marked by updateProcessedDoc, and returns those that match the
        query.<br>
 <br>
        <b>What documents are returned?</b><br>
        The following table describes the documents that are returned by
        unprocessedFTSearch. Document selection occurs once, before the
        agent runs.
 
        <table border="1">
        <tr>
        <th>Agent runs on:</th>
        <th>UnprocessedDocuments returns documents that meet all of these
        requirements:</th>
        </tr>
        <tr>
        <td>All documents in database</td>
        <td>Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search critieria specified in this method</td>
        </tr>
        <tr>
        <td>All new & modified documents</td>
        <td>Not processed by this agent with updateProcessedDoc<br>
 
        Created or modified since the agent last ran<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search critieria specified in this method</td>
        </tr>
        <tr>
        <td>All unread documents in view</td>
        <td>Are unread and in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>All documents in view</td>
        <td>Are in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>All selected documents</td>
        <td>Are selected in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>None</td>
        <td>Is the current document only</td>
        </tr>
        </table>
 
        <b>Using updateProcessedDoc</b><br>
        For agents that run on new and modified documents, you must use
        updateProcessedDoc to mark each document as "processed," which
        ensures that a document gets processed by the agent only once
        (unless it's modified again). If you do not call this method for
        each document, the agent processes the same documents the next
        time it runs.<br>
 
        The updateProcessedDoc method marks a document as processed only
        for the particular agent from which it is called. Using
        updateProcessedDoc in one agent has no effect on the documents
        that another agent processes.<br>
 
        In all other agents and view actions, updateProcessedDoc has no
        effect.<br>
 
        <b>View actions</b><br>
        When used in a view action, unprocessedFTSearch returns the same
        documents as an agent that runs on selected documents.<br>
 
        <b>Full-text indexes</b><br>
        If the database is not full-text indexed, this method works, but
        less efficiently. To test for an index, use isFTIndexed. To create
        an index on a local database, use updateFTIndex.<br>
 
        This method returns a maximum of 5,000 documents by default. The
        Notes.ini variable FT_MAX_SEARCH_RESULTS overrides this limit for
        indexed databases or databases that are not indexed but that are
        running in an agent on the client. For a database that is not
        indexed and is running in an agent on the server, you must set the
        TEMP_INDEX_MAX_DOC Notes.ini variable as well. The absolute
        maximum is 2,147,483,647.<br>
 
        <b>Options</b><br>
        If you don't specify any sort options, the documents are sorted by
        relevance score. When the collection is sorted by relevance the
        highest relevance appears first. To access the relevance score of
        each document in the collection, use FTSearchScore in Document.<br>
 
        If you ask for a sort by date, you don't get relevance scores. If
        you pass the resulting DocumentCollection to a Newsletter object,
        it formats its doclink report with either the document creation
        date or the relevance score, depending on the sort options.<br>
 
        <b>Query syntax</b><br>
        To search for a word or phrase, enter the word or phrase as is,
        except that search keywords must be enclosed in quotes. Remember
        to escape quotes if you are inside a literal.<br>
 
        Wildcards, operators, and other syntax are permitted. For the
        complete syntax rules, see
        "Refining a search query using operators" in Lotus Notes Help.
        Search for "query syntax" in the Domino Designer Eclipse help
        system or information center (for example,
        http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp),
        both of which include Lotus Notes.<br></dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent, which runs on selected documents, returns the
          selected documents that contain a specified string, in groups of
          eight.
 
          <pre>
 import lotus.domino.*;
 import java.util.Vector;
 
 public class JavaAgent extends AgentBase {
 
        public void NotesMain() {
 
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
 
                        // (Your code goes here)
                        Database db = agentContext.getCurrentDatabase();
 
                        // Get query string and put in quotes
                        String query = &quot;foo&quot;;
                        query = &quot;\&quot;&quot; + query + &quot;\&quot;&quot;;
                        // Get first 8 documents that match the query
                        int start = 1;
                        DocumentCollection dc = agentContext.unprocessedFTSearchRange(
                                        query, 8, Database.FT_SCORES, Database.FT_STEMS, start);
                        while (dc.getCount() &gt; 0) {
                                System.out.println(&quot;Documents &quot; + start + &quot; though &quot;
                                                + (start + dc.getCount() - 1));
                                Document doc = dc.getFirstDocument();
                                while (doc != null) {
                                        System.out
                                                        .println(&quot;\t&quot; + doc.getItemValueString(&quot;Subject&quot;));
                                        doc = dc.getNextDocument(doc);
                                }
                                // Get next 8 documents that match query
                                start = start + 8;
                                dc = agentContext.unprocessedFTSearchRange(query, 8,
                                                Database.FT_SCORES, Database.FT_FUZZY, start);
                        }
 
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="unprocessedFTSearchRange(java.lang.String, int, int, int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unprocessedFTSearchRange</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a>&nbsp;unprocessedFTSearchRange(java.lang.String&nbsp;query,
                                               int&nbsp;maxdocs,
                                               int&nbsp;sortopt,
                                               int&nbsp;otheropt,
                                               int&nbsp;start)
                                                 throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">Given a full-text query, returns documents in a database:
 
 <ul>
 <li>That the current agent considers to be unprocessed</li>
 <li>And that match the query</li>
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>query</code> - The full-text query.</dd><dd><code>maxdocs</code> - The maximum number of documents you want returned; 0 means all
            matching documents.</dd><dd><code>sortopt</code> - Use one of these to specify a sorting option:
 
            <ul>
            <li>Database.FT_SCORES (default) sorts by relevance score with
            highest relevance first.</li>
            <li>Database.FT_DATECREATED_DES sorts by document creation
            date in descending order.</li>
            <li>Database.FT_DATECREATED_ASC sorts by document creation
            date in ascending order.</li>
            <li>Database.FT_DATE_DES sorts by document date in descending
            order.</li>
            <li>Database.FT_DATE_ASC sorts by document date in ascending
            order.</li>
            </ul></dd><dd><code>otheropt</code> - Integer. Use the following constants to specify additional
            search options. To specify more than one option, use a logical
            OR operation
            <ul>
            <li>Database.FT_DATABASE includes Lotus Domino databases in
            the search scope.</li>
            <li>Database.FT_FILESYSTEM includes files other than Lotus
            Domino databases in the search scope.</li>
            <li>Database.FT_FUZZY specifies a fuzzy search.</li>
            <li>Database.FT_STEMS uses stem words as the basis of the
            search.</li>
            </ul></dd><dd><code>start</code> - The starting document to return.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A sorted collection of documents that are not yet processed and
         match the query.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>This method is valid only for agents.<br>
 
        <b>How does it work?</b><br>
        This method works in two parts:<br>
 
        <ul>
        <li>First, it finds a collection of documents that the agent
        considers to be "unprocessed." The type of agent determines which
        documents are considered to be unprocessed. This document
        collection is identical to that returned by
        getUnprocessedDocuments.</li>
        <li>Second, it conducts a full-text search on the unprocessed
        documents and returns a collection of those documents that match
        the query.</li>
        </ul>
        For example, in an agent that runs on all selected documents in a
        view, getUnprocessedFTSearch searches only the selected documents
        and returns those that match the query. In an agent that runs on
        all new and modified documents since the last run,
        getUnprocessedFTSearch searches only the documents that were not
        marked by updateProcessedDoc, and returns those that match the
        query.<br>
 <br>
        <b>What documents are returned?</b><br>
        The following table describes the documents that are returned by
        unprocessedFTSearch. Document selection occurs once, before the
        agent runs.
 
        <table border="1">
        <tr>
        <th>Agent runs on:</th>
        <th>UnprocessedDocuments returns documents that meet all of these
        requirements:</th>
        </tr>
        <tr>
        <td>All documents in database</td>
        <td>Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search critieria specified in this method</td>
        </tr>
        <tr>
        <td>All new & modified documents</td>
        <td>Not processed by this agent with updateProcessedDoc<br>
 
        Created or modified since the agent last ran<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search critieria specified in this method</td>
        </tr>
        <tr>
        <td>All unread documents in view</td>
        <td>Are unread and in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>All documents in view</td>
        <td>Are in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>All selected documents</td>
        <td>Are selected in the view<br>
 
        Meet the search criteria specified in Agent Properties box<br>
 
        Meet the full-text search criteria specified in this method</td>
        </tr>
        <tr>
        <td>None</td>
        <td>Is the current document only</td>
        </tr>
        </table>
 
        <b>Using updateProcessedDoc</b><br>
        For agents that run on new and modified documents, you must use
        updateProcessedDoc to mark each document as "processed," which
        ensures that a document gets processed by the agent only once
        (unless it's modified again). If you do not call this method for
        each document, the agent processes the same documents the next
        time it runs.<br>
 
        The updateProcessedDoc method marks a document as processed only
        for the particular agent from which it is called. Using
        updateProcessedDoc in one agent has no effect on the documents
        that another agent processes.<br>
 
        In all other agents and view actions, updateProcessedDoc has no
        effect.<br>
 
        <b>View actions</b><br>
        When used in a view action, unprocessedFTSearch returns the same
        documents as an agent that runs on selected documents.<br>
 
        <b>Full-text indexes</b><br>
        If the database is not full-text indexed, this method works, but
        less efficiently. To test for an index, use isFTIndexed. To create
        an index on a local database, use updateFTIndex.<br>
 
        This method returns a maximum of 5,000 documents by default. The
        Notes.ini variable FT_MAX_SEARCH_RESULTS overrides this limit for
        indexed databases or databases that are not indexed but that are
        running in an agent on the client. For a database that is not
        indexed and is running in an agent on the server, you must set the
        TEMP_INDEX_MAX_DOC Notes.ini variable as well. The absolute
        maximum is 2,147,483,647.<br>
 
        <b>Options</b><br>
        If you don't specify any sort options, the documents are sorted by
        relevance score. When the collection is sorted by relevance the
        highest relevance appears first. To access the relevance score of
        each document in the collection, use FTSearchScore in Document.<br>
 
        If you ask for a sort by date, you don't get relevance scores. If
        you pass the resulting DocumentCollection to a Newsletter object,
        it formats its doclink report with either the document creation
        date or the relevance score, depending on the sort options.<br>
 
        <b>Query syntax</b><br>
        To search for a word or phrase, enter the word or phrase as is,
        except that search keywords must be enclosed in quotes. Remember
        to escape quotes if you are inside a literal.<br>
 
        Wildcards, operators, and other syntax are permitted. For the
        complete syntax rules, see
        "Refining a search query using operators" in Lotus Notes Help.
        Search for "query syntax" in the Domino Designer Eclipse help
        system or information center (for example,
        http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp),
        both of which include Lotus Notes.<br></dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent, which runs on selected documents, returns the
          selected documents that contain a specified string, in groups of
          eight.
 
          <pre>
 import lotus.domino.*;
 import java.util.Vector;
 
 public class JavaAgent extends AgentBase {
 
        public void NotesMain() {
 
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
 
                        // (Your code goes here)
                        Database db = agentContext.getCurrentDatabase();
 
                        // Get query string and put in quotes
                        String query = &quot;foo&quot;;
                        query = &quot;\&quot;&quot; + query + &quot;\&quot;&quot;;
                        // Get first 8 documents that match the query
                        int start = 1;
                        DocumentCollection dc = agentContext.unprocessedFTSearchRange(
                                        query, 8, Database.FT_SCORES, Database.FT_STEMS, start);
                        while (dc.getCount() &gt; 0) {
                                System.out.println(&quot;Documents &quot; + start + &quot; though &quot;
                                                + (start + dc.getCount() - 1));
                                Document doc = dc.getFirstDocument();
                                while (doc != null) {
                                        System.out
                                                        .println(&quot;\t&quot; + doc.getItemValueString(&quot;Subject&quot;));
                                        doc = dc.getNextDocument(doc);
                                }
                                // Get next 8 documents that match query
                                start = start + 8;
                                dc = agentContext.unprocessedFTSearchRange(query, 8,
                                                Database.FT_SCORES, Database.FT_FUZZY, start);
                        }
 
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="unprocessedSearch(java.lang.String, org.openntf.domino.mock.interfaces.NotesDateTime, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unprocessedSearch</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a>&nbsp;unprocessedSearch(java.lang.String&nbsp;formula,
                                        <a href="../../../../../org/openntf/domino/mock/interfaces/NotesDateTime.html" title="interface in org.openntf.domino.mock.interfaces">NotesDateTime</a>&nbsp;limit,
                                        int&nbsp;maxDocs)
                                          throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">Given selection criteria, returns documents in a database that:
 <ul>
 <li>The current agent considers to be unprocessed</li>
 <li>Meet the selection criteria</li>
 <li>Were created or modified since the cutoff date</li>
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>formula</code> - A Lotus Domino formula that defines the selection criteria</dd><dd><code>limit</code> - A cutoff date</dd><dd><code>maxDocs</code> - The maximum number of documents you want returned; 0 means all
            matching documents.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A collection of documents that are not yet processed, match the
         selection criteria, and were created or modified after the cutoff
         date. The collection is sorted by relevance with highest
         relevance first</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code> - * @usage This method is valid only for agents.<br>
 
             <b>How does it work?</b><br>
             This method works in two parts:<br>
 
             <ul>
             <li>First, it finds a collection of documents that the agent
             considers to be "unprocessed." The type of agent determines
             which documents are considered to be unprocessed. This
             document collection is identical to that returned by
             getUnprocessedDocuments.</li>
             <li>Second, it conducts a full-text search on the unprocessed
             documents and returns a collection of those documents that
             match the query.</li>
             </ul>
             For example, in an agent that runs on all selected documents
             in a view, getUnprocessedFTSearch searches only the selected
             documents and returns those that match the query. In an agent
             that runs on all new and modified documents since the last
             run, getUnprocessedFTSearch searches only the documents that
             were not marked by updateProcessedDoc, and returns those that
             match the query.<br>
 <br>
             <b>What documents are returned?</b><br>
             The following table describes the documents that are returned
             by unprocessedFTSearch. Document selection occurs once,
             before the agent runs.
 
             <table border="1">
             <tr>
             <th>Agent runs on:</th>
             <th>UnprocessedDocuments returns documents that meet all of
             these requirements:</th>
             </tr>
             <tr>
             <td>All documents in database</td>
             <td>Meet the search criteria specified in Agent Properties
             box<br>
 
             Meet the full-text search critieria specified in this method</td>
             </tr>
             <tr>
             <td>All new & modified documents</td>
             <td>Not processed by this agent with updateProcessedDoc<br>
 
             Created or modified since the agent last ran<br>
 
             Meet the search criteria specified in Agent Properties box<br>
 
             Meet the full-text search critieria specified in this method</td>
             </tr>
             <tr>
             <td>All unread documents in view</td>
             <td>Are unread and in the view<br>
 
             Meet the search criteria specified in Agent Properties box<br>
 
             Meet the full-text search criteria specified in this method</td>
             </tr>
             <tr>
             <td>All documents in view</td>
             <td>Are in the view<br>
 
             Meet the search criteria specified in Agent Properties box<br>
 
             Meet the full-text search criteria specified in this method</td>
             </tr>
             <tr>
             <td>All selected documents</td>
             <td>Are selected in the view<br>
 
             Meet the search criteria specified in Agent Properties box<br>
 
             Meet the full-text search criteria specified in this method</td>
             </tr>
             <tr>
             <td>None</td>
             <td>Is the current document only</td>
             </tr>
             </table>
 
             <b>Using updateProcessedDoc</b><br>
             For agents that run on new and modified documents, you must
             use updateProcessedDoc to mark each document as "processed,"
             which ensures that a document gets processed by the agent
             only once (unless it's modified again). If you do not call
             this method for each document, the agent processes the same
             documents the next time it runs.<br>
 
             The updateProcessedDoc method marks a document as processed
             only for the particular agent from which it is called. Using
             updateProcessedDoc in one agent has no effect on the
             documents that another agent processes.<br>
 
             In all other agents and view actions, updateProcessedDoc has
             no effect.<br></dd><dt><span class="strong">Example:</span></dt>
  <dd>This agent searches all or selected documents for documents
          created after January 1, 1999 that contain "botany" in the
          Subject field, and places them in the "Botanist's Delight"
          folder.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        DateTime date = session.createDateTime(&quot;01/01/99&quot;);
                        DocumentCollection dc = agentContext.unprocessedSearch(
                                        &quot;@Contains(Subject; \&quot;botany\&quot;)&quot;, date, 0);
                        Document doc = dc.getFirstDocument();
                        while (doc != null) {
                                doc.putInFolder(&quot;Botanist's Delight&quot;);
                                agentContext.updateProcessedDoc(doc);
                                System.out.println(doc.getItemValueString(&quot;Subject&quot;));
                                doc = dc.getNextDocument();
                        }
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="getEffectiveUserName()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEffectiveUserName</h4>
<pre>java.lang.String&nbsp;getEffectiveUserName()
                                      throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">The user name that is in effect for the current program.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The user name that is in effect for the current program. For a
         program running on:
         <ul>
         <li>A workstation, this is the name of the current user.</li>
         <li>A server, the identity of the person under whose identity the
         program is running.</li>
         </ul></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>The identity of the person under whose identity the program is
        running depends on whether you are running an agent, an XPage, a
        servlet, or a stand alone program.
 
        For an agent, selecting 'run as web user' will make this property
        use the identity of the logged in web user. If 'run as web user'
        is not selected, this property will use the identity of the agent
        signer.
 
        For everything else the identity is the identity established by
        the Session or automatically assigned by the environment.
 
        This property returns the fully distinguished name.
 
        For Java agents, this property will return the same value as the
        EffectiveUserName property in the Java Session class.</dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This example prints the current effective user name.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        String name = agentContext.getEffectiveUserName();
                        System.out.println(&quot;Effective user name is &quot; + name);
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="getCurrentAgent()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCurrentAgent</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgent.html" title="interface in org.openntf.domino.mock.interfaces">NotesAgent</a>&nbsp;getCurrentAgent()
                           throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">The agent that's currently running.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The agent that's currently running.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Example:</span></dt>
  <dd>This agent prints the name of the current agent.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        Agent agent = agentContext.getCurrentAgent();
                        String name = agent.getName();
                        System.out.println(&quot;Current agent is \&quot;&quot; + name + &quot;\&quot;&quot;);
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="getCurrentDatabase()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCurrentDatabase</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDatabase.html" title="interface in org.openntf.domino.mock.interfaces">NotesDatabase</a>&nbsp;getCurrentDatabase()
                                 throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">The database in which the current agent resides.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The database in which the current agent resides.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>This property allows you to access a database without having to
        specify its server and file name. Using getCurrentDatabase can
        make programs more portable from one database to another.</dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent example prints the title of the current database.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        Database db = agentContext.getCurrentDatabase();
                        String title = db.getTitle();
                        System.out.println(&quot;Current database is \&quot;&quot; + title + &quot;\&quot;&quot;);
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="getDocumentContext()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDocumentContext</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocument.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocument</a>&nbsp;getDocumentContext()
                                 throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">The in-memory document when an agent starts.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The in-memory document when an agent starts.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>For an agent activated in a view through the Notes client UI, the
        in-memory document is the document highlighted in the view.
 
        For an agent activated "Before New Mail Arrives," the in-memory
        document is the email that is about to be delivered. Because the
        agent is activated instantly for each email as it's about to be
        saved into the mail database, each time the agent runs you are
        working with a single unsaved document. The UnprocessedDocuments
        property in AgentContext will not return any documents for this
        agent type.
 
        For an agent run from a browser with the OpenAgent URL command,
        the in-memory document is a new document containing an item for
        each CGI (Common Gateway Interface) variable supported by Domino.
        Each item has the name and current value of a supported CGI
        variable. (No design work on your part is needed; the CGI
        variables are available automatically.)
 
        For an agent run from a browser with @Command([RunAgent]) or</dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent prints the value of the Subject field of the
          in-memory document.
 
          1. This agent displays the Subject item of the current document
          when run from a view in the Notes client.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
 
        public void NotesMain() {
 
         try {
           Session session = getSession();
           AgentContext agentContext = session.getAgentContext();
 
           // (Your code goes here) 
           Document doc = agentContext.getDocumentContext();
           System.out.println
             (doc.getItemValueString(&quot;Subject&quot;));/
 
         } catch(Exception e) {
             e.printStackTrace();
         }
     }
 }
 </pre>
 
          2. This agent displays the Subject item of the current document
          when run by @Command([RunAgent]) in a browser.
 
          <pre>
 import lotus.domino.*;
 import java.io.PrintWriter;
 
 public class JavaAgent extends AgentBase {
 
        public void NotesMain() {
 
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
 
                        // (Your code goes here)
                        Document doc = agentContext.getDocumentContext();
                        PrintWriter pw = getAgentOutput();
                        pw.println(&quot;&lt;H2&gt;&quot; + doc.getItemValueString(&quot;Subject&quot;) + &quot;&lt;/H2&gt;&quot;);
 
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre>
 
          3. This agent displays the CGI variable Remote_Addr when run in
          a browser by the OpenAgent URL command, or by</dd></dl>
</li>
</ul>
<a name="getLastExitStatus()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastExitStatus</h4>
<pre>int&nbsp;getLastExitStatus()
                      throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">The exit status code returned by the Agent Manager the last time the
 current agent ran.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The exit status code returned by the Agent Manager the last time
         the current agent ran.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>This property returns 0 if the agent ran without errors.</dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent prints the last exit status of the current agent.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        int status = agentContext.getLastExitStatus();
                        System.out.println(&quot;Last exit status was &quot; + status);
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="getLastRun()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastRun</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDateTime.html" title="interface in org.openntf.domino.mock.interfaces">NotesDateTime</a>&nbsp;getLastRun()
                         throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">The date and time when the current agent was last executed.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The date and time when the current agent was last executed.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>If the agent never ran before, this property returns null.</dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent prints the date and time that the agent last ran.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        DateTime date = agentContext.getLastRun();
                        if (date.getDateOnly().equals(&quot;&quot;))
                                System.out.println(&quot;Agent was not run before&quot;);
                        else
                                System.out.println(&quot;Agent was last run on &quot;
                                                + date.getDateOnly() + &quot; at &quot; + date.getTimeOnly());
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="getSavedData()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSavedData</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocument.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocument</a>&nbsp;getSavedData()
                           throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">A document that an agent uses to store information between invocations.
 The agent can use the information in this document the next time the
 agent runs.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>A document that an agent uses to store information between
         invocations. The agent can use the information in this document
         the next time the agent runs.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>The getSavedData document is created when you save an agent, and
        it is stored in the same database as the agent. The document
        replicates, but is not displayed in views.
 
        Each time you edit and re-save an agent, its getSavedData document
        is deleted and a new, blank one is created. When you delete an
        agent, its getSavedData document is deleted.</dd>
<dt><span class="strong">Example:</span></dt>
  <dd>This agent uses the save data record to find the maximum weekly
          sales.The data records have Weeky_Sales and Name fields. The
          saved data record has MaxSales and MaxSales_Salesperson fields.
          The data record fields replace the agent record fields whenever
          Weekly_Sales is greater than MaxSales.
 
          <pre>
 import lotus.domino.*;
 import java.util.Vector;
 import java.lang.Float;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        Document agentDoc = agentContext.getSavedData();
                        Database db = agentContext.getCurrentDatabase();
                        View view = db.getView(&quot;Weekly Sales&quot;);
                        Document doc = view.getFirstDocument();
                        if (!agentDoc.hasItem(&quot;MaxSales&quot;)) {
                                agentDoc.replaceItemValue(&quot;MaxSales&quot;, &quot;0&quot;);
                                agentDoc.save(true, true);
                                agentDoc = agentContext.getSavedData();
                        }
                        while (doc != null) {
                                Vector mvalue = agentDoc.getItemValue(&quot;MaxSales&quot;);
                                Vector wvalue = doc.getItemValue(&quot;Weekly_Sales&quot;);
                                Float maxSales = new Float((String) mvalue.firstElement());
                                Float weeklySales = new Float((String) wvalue.firstElement());
                                if (weeklySales.floatValue() &gt; maxSales.floatValue()) {
                                        agentDoc.replaceItemValue(&quot;MaxSales&quot;,
                                                        doc.getItemValue(&quot;Weekly_Sales&quot;));
                                        agentDoc.replaceItemValue(&quot;MaxSales_Salesperson&quot;,
                                                        doc.getItemValue(&quot;Name&quot;));
                                }
                                agentDoc.save(true, true);
                                System.out.println(&quot;Best salesperson to date is &quot;
                                                + agentDoc.getItemValue(&quot;MaxSales_Salesperson&quot;)
                                                + &quot; who sold $&quot; + agentDoc.getItemValue(&quot;MaxSales&quot;));
                        }
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
<a name="getUnprocessedDocuments()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getUnprocessedDocuments</h4>
<pre><a href="../../../../../org/openntf/domino/mock/interfaces/NotesDocumentCollection.html" title="interface in org.openntf.domino.mock.interfaces">NotesDocumentCollection</a>&nbsp;getUnprocessedDocuments()
                                                throws <a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></pre>
<div class="block">The documents in a database that the current agent considers to be
 "unprocessed." The type of agent determines which documents are
 considered unprocessed.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The documents in a database that the current agent considers to
         be "unprocessed." The type of agent determines which documents
         are considered unprocessed.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/openntf/domino/mock/Exception/NotesApiException.html" title="class in org.openntf.domino.mock.Exception">NotesApiException</a></code></dd><dt><span class="strong">Usage:</span></dt>
  <dd>This method is valid only for agents.
 
        What documents are returned? <br>
        The following table describes the documents that are returned by
        getUnprocessedDocuments. Document selection occurs once, before
        the agent runs.
        <table border="1">
        <tr>
        <th>Agent runs on:</th>
        <th>UnprocessedDocuments returns documents that meet all of these
        requirements:</th>
        </tr>
        <tr>
        <td>All documents in database</td>
        <td>Meet the search criteria specified in Agent Properties box</td>
        </tr>
        <tr>
        <td>
        All new & modified documents</td>
        <td>
        <ul>
        <li>Not processed by this agent with updateProcessedDoc</li>
        <li>Created or modified since the agent last ran</li>
        <li>Meet the search criteria specified in Agent Properties box</li>
        </ul>
        </td>
        </tr>
        <tr>
        <td>
        All unread documents in view</td>
        <td>
        <ul>
        <li>Are unread and in the view</li>
        <li>Meet the search criteria specified in Agent Properties box</li>
        </ul>
        </td>
        </tr>
        <tr>
        <td>All documents in view</td>
        <td>
        <ul>
        <li>Are in the view</li>
        <li>Meet the search criteria specified in Agent Properties box</li>
        </ul>
        </td>
        </tr>
        <tr>
        <td>
        All selected documents</td>
        <td>
        <ul>
        <li>Are selected in the view</li>
        <li>Meet the search criteria specified in Agent Properties box</li>
        </ul>
        </td>
        </tr>
        <tr>
        <td>
        None</td>
        <td>Is the current document only</td>
        </tr>
        <tr>
        <td>
        Before New Mail Arrives</td>
        <td>None (does not return any documents; use DocumentContext in
        AgentContext instead)</td>
        </tr>
        <tr>
        <td>After New Mail Arrives</td>
        <td>
        <ul>
        <li>Mailed to the database since the agent last ran</li>
        <li>Meet the search criteria specified in Agent Properties box</li>
        </ul>
        </td>
        </tr>
        <tr>
        <td>
        Newly modified documents</td>
        <td>
        <ul>
        <li>Modified since the agent last ran</li>
        <li>Meet the search criteria specified in Agent Properties box</li>
        </ul>
        </td>
        </tr>
        <tr>
        <td>
        Pasted documents</td>
        <td>
        <ul>
        <li>Pasted into the database since the agent last ran</li>
        <li>Meet the search criteria specified in Agent Properties box</li>
        </ul>
        </td>
        </tr>
        </table>
 
        Using UpdateProcessedDoc <br>
        For agents that run on new and modified documents, you must use
        updateProcessedDoc in Session to mark each document as
        "processed," which ensures that a document gets processed by the
        agent only once (unless it's modified again). If you do not call
        this method for each document, the agent processes the same
        documents the next time it runs.
 
        The updateProcessedDoc method marks a document as processed only
        for the particular agent from which it is called. Using
        updateProcessedDoc in one agent has no effect on the documents
        that another agent processes.</dd>
<dt><span class="strong">Example:</span></dt>
  <dd>If this agent runs on selected documents,
          getUnprocessedDocuments returns the selected documents.
 
          <pre>
 import lotus.domino.*;
 
 public class JavaAgent extends AgentBase {
        public void NotesMain() {
                try {
                        Session session = getSession();
                        AgentContext agentContext = session.getAgentContext();
                        // (Your code goes here)
                        DocumentCollection dc = agentContext.getUnprocessedDocuments();
                        System.out.println(&quot;Count = &quot; + dc.getCount());
                        Document doc = dc.getFirstDocument();
                        while (doc != null) {
                                System.out.println(doc.getItemValueString(&quot;Subject&quot;));
                                doc = dc.getNextDocument();
                        }
                } catch (Exception e) {
                        e.printStackTrace();
                }
        }
 }
 </pre></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/NotesAgentContext.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/openntf/domino/mock/interfaces/NotesAgent.html" title="interface in org.openntf.domino.mock.interfaces"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/openntf/domino/mock/interfaces/NotesBase.html" title="interface in org.openntf.domino.mock.interfaces"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/openntf/domino/mock/interfaces/NotesAgentContext.html" target="_top">Frames</a></li>
<li><a href="NotesAgentContext.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
